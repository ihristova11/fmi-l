\section{Тема 10}

\subsection{Рекурентни уравнения (РУ) - линейни с константни коефициенти и крайна история – 
хомогенни и нехомогенни. Примери.}

\begin{definition}
    Уравнението \mexpr{a_n = c_1.a_{n - 1} + c_2.a_{n - 2} + ... + c_k.a_{n - k}}, където 
    \mexpr{c_1, ..., c_k} са (целочислени) константи, \mexpr{c_k \not = 0, k = const}, се нарича линейно 
    (хомогенно) рекурентно уравнение (ЛХРУ) от \(k\)-ти ред с константни коефициенти и крайна история.
\end{definition}

Началните условия са \(k\) на брой - \mexpr{a_1 = q_1, ..., a_k = q_k}, където \(q_i\) са цели числа.

\begin{note}
    Уравнението 
    \begin{equation*}
        T_n = 
        \begin{cases}
            n * T_{n - 1} & \text{ако \(n \ge 1\)} \\
            1 & \text{ако \(n = 0\)}
        \end{cases}
    \end{equation*}
    не е с константни коефициенти. \\
    Уравнението 
    \begin{equation*}
        S_n = 
        \begin{cases}
            S_{n - 1} + S_{n - 2} + ... + S_1 + S_0 & \text{ако \(n \ge 1\)} \\
            1 & \text{ако \(n = 0\)}
        \end{cases}
    \end{equation*}
    не е с крайна история. 
\end{note}

Такива уравнения не могат да се решат със следния алгоритъм:
\begin{enumerate}
    \item Конструираме характеристичното у-е на даденото ни ЛХРУ
    \begin{itemize}
        \item заместваме \(a_i\) с \(x^i\) за \(i \in {n - k, ..., n}\) и получаваме \\
        \mexpr{x^n = c_1 x^{n - 1} + c_2 x^{n - 2} + ... + c_{k - 1} x^{n - k + 1} + c_k x^{n - k}}
        \item делим на \(x^{n - k}\) и получаваме \mexpr{x^k = c_1 x^{k - 1} + c_2 x^{k - 2} + ... + c_{k - 1} x + c_k}
    \end{itemize}
\end{enumerate}

Съгласно основната теорема на алгебрата, характеристичното у-е има \(k\) на брой, не непременно различни, 
комплексни корени.

Нека \(\{\alpha_1, ..., \alpha_k\}_M\) е мултимножеството от корените.

\begin{itemize}
    \item ако корените са два по два различни, то общото решение е \mexpr{a_n = A_1\alpha_1^n + ... + A_k\alpha_k^n}, 
    където \(A_1, ..., A_k\) са неизвестни константи.
    \begin{itemize}
        \item ако началните условия не са дадени, то не можем да намерим тези константи и решението именно горното у-е
        \item ако началните условия са дадени (\(k\) на брой), то можем да намерим \(A_1, ..., A_k\), замествайки \(n\) 
        със стойностите на аргумента в началните условия. Получаваме система от \(k\) линейни уравнения с \(k\)
        неизвестни. Решаваме системата, намираме константите и заместваме в горното у-е.
    \end{itemize}
    \item нека различните корени са \mexpr{\beta_1, ..., \beta_t} за \(t \le k\).
    Нека \(\beta_i\) има кратност \(r_i\) за \(1 \le i \le t\), като \mexpr{r_1 + ... + r_t = k}. \\
    Тогава общото решение е
    \begin{align*}
        a_n = &A_{1, 1}\beta_1^n + A_{1, 2}n\beta_1^n + ... + A_{1, r_1}n^{r_1 - 1}\beta_1^n + \\
              &A_{2, 1}\beta_2^n + A_{2, 2}n\beta_2^n + ... + A_{2, r_2}n^{r_2 - 1}\beta_2^n + \\
              &... + \\
              &A_{t, 1}\beta_t^n + A_{t, 2}n\beta_1^n + ... + A_{t, r_1}n^{r_t - 1}\beta_t^n
    \end{align*}
\end{itemize}
Двойно индексираните константи \(A_{i, j}\) са точно \(k\) на брой и може да бъдат намерени от началните условия.

\begin{example}
    Нека \mexpr{a_n = 12a_{n - 1} - 51a_{n - 2} + 92a_{n - 3} - 60a_{n - 4}} с начални условия 
    \mexpr{a_1 = 1, a_2 = 2, a_3 = 4, a_4 = 6}. \\
    Характеристичното у-е е \mexpr{x^4 - 12x^3 + 51x^2 - 92x + 60 = 0 \iff (x - 2)^2(x - 3)(x - 5) = 0}. \\
    Мултимножеството от корените му е \(\{2, 2, 3, 5\}_M\). \\
    Тогава общото му решение е \mexpr{a_n = A2^n + Bn2^n + C3^n + D5^n} за константите \(A, B, C, D\). \\
    Константите получаваме от началните условия:
    \begin{align*}
        a_1 &= A.2^1 + B.1.2^1 + C.3^1 + D.5^1 \\
        a_2 &= A.2^2 + B.2.2^2 + C.3^2 + D.5^2 \\
        a_3 &= A.2^3 + B.3.2^3 + C.3^3 + D.5^3 \\
        a_4 &= A.2^4 + B.4.2^4 + C.3^4 + D.5^4
    \end{align*}
    Знаем началните условия и ги заместваме:
    \begin{align*}
        1 &= 2.A + 2.B + 3.C + 5.D \\
        2 &= 4.A + 8.B + 9.C + 25.D \\
        4 &= 8.A + 24.B + 27.C + 125.D \\
        6 &= 16.A + 64.B + 81.C + 625.D
    \end{align*}
\end{example}

Получаваме, че константите са \mexpr{A = \frac{2}{9}, B = \frac{-1}{6}, C = \frac{1}{3}, D = \frac{-1}{45}}. \\
Тогава решението е \mexpr{a_n = \frac{2^{n + 1}}{9} - \frac{n.2^n}{6} + 3^{n - 1} - \frac{5^n}{45}}.

\begin{definition}
    Уравнението \\
    \mexpr{a_n = \underbrace{c_1.a_{n - 1} + c_2.a_{n - 2} + ... + c_k.a_{n - k}}_\text{хомогенна част} + 
    \underbrace{p_1(n).b_1^n + ... + p_l(n).b_l^n}_\text{нехомогенна част}}, \\
    където \(k, l, c_1, ..., c_k\) са константи, \(b_1, ..., b_l\) са две по две различни константи, а
    \(p_1(n), ..., p_l(n)\) са полиноми на \(n\), се нарича линейно (нехомогенно) рекурентно 
    уравнение (ЛНХРУ) от \(k\)-ти ред с константни коефициенти и крайна история.
\end{definition}

Алгоритъм за решаване:
\begin{enumerate}
    \item Съставя са характеристичното у-е само от хомогенната част и се намира мултимножеството \(X\) от корените му.
    \item Нека \(Y\) е мултимножеството от числата \(b_1, ..., b_l\), всяко от които има кратност колкото 
    е степента на съответния полином + 1
    \item Обединяваме мултимножествата \(X\) и \(Y\) и съставяме общото решение спрямо това обединение
\end{enumerate}

Неизвестните константи се намират чрез началните условия, които са \(k\) на брой. Обединението на \(X\) и \(Y\)
има мощност \(k + l\), така че неизвестните константи са \(k + l\) на брой. За да ги намерим си правим още
\(l\) начални условия от даденото ни първоначално уравнение.

\begin{example}
    Нека 
    \begin{equation*}
        L(n) = 
        \begin{cases}
            L(n - 1) + n & \text{ако \(n \ge 1\)} \\
            1 & \text{ако \(n = 0\)}
        \end{cases}
    \end{equation*}
    Тогава \mexpr{L(n) = \underbrace{L(n - 1)}_\text{хомогенна част} + \underbrace{n^1.1^n}_\text{нехомогенна част}}
    \begin{enumerate}
        \item Характеристичното у-е е \mexpr{x - 1 = 0} и мултимножеството от корените е \mexpr{X = \{1\}_M}
        \item От нехомогенната част образуваме мултимножеството \mexpr{Y = \{1, 1\}_M}, което съдържа 1-ци, 
        защото основата на експонентата е 1-ца, а броят им е две, защото степента на полинома е едно + още 1.
        \item Обединението на \(X\) и \(Y\) е \mexpr{\{1, 1, 1\}_M}
    \end{enumerate}
    Общото решение е \mexpr{L(n) = A.1^n + B.n.1^n + C.n^2.1^n = A + B.n + C.n^2}. \\
    За да намерим \(A, B\) и \(C\) трябва да направим още 2 начални условия, освен даденото, т.е.
    \mexpr{L(1) = 2, L(2) = 4} и съставяме системата:
    \begin{align*}
        1 &= A + B.0 + C.0^2 = A \\
        2 &= A + B.1 + C.1^2 = A + B + C \\
        4 &= A + B.2 + C.4
    \end{align*}
    Намираме, че \mexpr{A = 1, B = C = \frac{1}{2}}. \\
    Тогава \mexpr{L(n) = 1 + \frac{n + n^2}{2} = 1 + \frac{n.(n + 1)}{2}}.
\end{example}

\subsection{Примери за броене в комбинаториката чрез рекурентни уравнения}