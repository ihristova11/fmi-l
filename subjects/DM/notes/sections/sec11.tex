\section{Тема 11}

\subsection*{Крайни мултиграфи и графи – ориентирани и неориентирани. Дефиниции}

\begin{definition}
    Краен неориентиран граф е наредена двойка \mexpr{G = (V, E)}, където \mexpr{V = \{v_1, ..., v_n\}} е 
    крайно непразно множество от върхове, \mexpr{E = \{e_1, ..., e_m\}} е крайно множество от ребра, като 
    \mexpr{E \subseteq \{X \subseteq V : |X| = 2\}}.
\end{definition}

\begin{definition}
    Краен неориентиран мултиграф е наредена тройка \mexpr{G = (V, E, f_G)}, където 
    \mexpr{V = \{v_1, ..., v_n\}} е крайно непразно множество от върхове, \mexpr{E = \{e_1, ..., e_m\}} 
    е крайно множество от ребра, \mexpr{V \cap E = \emptyset} и \mexpr{f_G : E \to \{X \subseteq V : |X| = 2\}} 
    е свързваща функция.
\end{definition}

\begin{definition}
    Краен ориентиран граф е наредена двойка \mexpr{G = (V, E)}, където \mexpr{V = \{v_1, ..., v_n\}} е 
    крайно непразно множество от върхове, \mexpr{E = \{e_1, ..., e_m\}} е крайно множество от ребра, като 
    \mexpr{E \subseteq (V \times V) \setminus \{(v, v) : v \in V\}}.
\end{definition}

\begin{definition}
    Краен ориентиран мултиграф е наредена тройка \mexpr{G = (V, E, f_G)}, където 
    \mexpr{V = \{v_1, ..., v_n\}} е крайно непразно множество от върхове, \mexpr{E = \{e_1, ..., e_m\}} 
    е крайно множество от ребра, \mexpr{V \cap E = \emptyset} и \mexpr{f_G : E \to V \times V} 
    е свързваща функция.
\end{definition}

\begin{note}
    Примери за графи.
\end{note}

\subsection*{Полустепени на входа и изхода, маршрути и контури в ориентирани графи}

\begin{definition}
    Нека \graf е ориентиран граф. \\
    За всеки връх \mexpr{v \in V}, входната степен (или полустепен на входа) на \(v\) е 
    \mexpr{|\{e \in E : v \text{е край на } e|}, а изходната степен (или полустепен на изхода) на \(v\) е
    \mexpr{|\{e \in E : v \text{е начало на } e|}. Бележим с \(d^-(v)\) входната степен, а с \(d^+(v)\) 
    изходната степен за \mexpr{v \in V}.
\end{definition}

\begin{definition}
    Ориентиран път (маршрут) в граф G наричаме всяка алтернираща редица от върхове и ребра за някое \(t \ge 0\): \\
    \mexpr{p = (v_{i_0}, e_{k_0}, v_{i_1}, e_{k_1}, v_{i_2}, ..., v_{i_{t - 1}}, e_{k_{t - 1}}, v_{i_t})}, където 
    \(v_{i_p} \in V\) за \mexpr{0 \le p \le t, e_{k_p} \in E} за \mexpr{0 \le p \le t - 1} и е изпълнено, че 
    \mexpr{f_G(e_{k_p}) = (v_{i_p}, v_{i_{p + 1}})} за \mexpr{0 \le p \le t - 1}. Казваме, че \(p\) е път 
    от \(v_{i_0}\) до \(v_{i_t}\).
\end{definition}

\begin{definition}
    Контур е маршрут, в който първият и последният връх съвпадат.
\end{definition}

\subsection*{Степени, пътища и цикли в неориентирани графи. Лема за ръкостисканията}

% TODO: stepeni
\begin{definition}
    Нека \graf е граф. \\
    Неориентиран път (или само път) в \(G\) наричаме всяка алтернираща редица от върхове и ребра за 
    някое \(t \ge 0\): \\
    \mexpr{p = (v_{i_0}, e_{k_0}, v_{i_1}, e_{k_1}, v_{i_2}, ..., v_{i_{t - 1}}, e_{k_{t - 1}}, v_{i_t})}, където 
    \(v_{i_p} \in V\) за \mexpr{0 \le p \le t, e_{k_p} \in E} за \mexpr{0 \le p \le t - 1} и е изпълнено, че 
    \mexpr{e_{k_p} = (v_{i_p}, v_{i_{p + 1}})} за \mexpr{0 \le p \le t - 1}.
\end{definition}

\begin{note}
    Връх \(v_{i_0}\) се нарича начало на пътя, а връх \(v_{i_t}\) се нарича край на пътя. Останалите 
    върхове са вътрешните върхове на пътя. \\
    Дължината на пътя е броят на ребрата в него. Бележим я с \(|p|\).
    Ако всички елементи на пътя - върхове и ребра са уникални, казваме, че \(p\) е прост (не)ориентиран път.
\end{note}

\begin{definition}
    Нека \graf е граф и \(p\) е път в него, като: \\
    \mexpr{p = (v_{i_0}, e_{k_0}, v_{i_1}, e_{k_1}, v_{i_2}, ..., v_{i_{t - 1}}, e_{k_{t - 1}}, v_{i_t})}. 
    Казваме, че \(p\) е цикъл, ако \(v_{i_0} = v_{i_t}\). \\
    Казваме, че \(p\) е прост цикъл, ако \(p\) е цикъл с поне едно ребро и освен това - всички елементи 
    са уникални освен \(v_{i_0} = v_{i_t}\).
\end{definition}

\begin{lemma}
    Нека \graf е граф с поне 2 върха. Тогава съществуват поне 2 различни върха \(u, v \in V\), такива че 
    \mexpr{d(u) = d(v)}.
\end{lemma}
\begin{proof}
    Знаем, че за всеки връх \mexpr{\forall v \in V : d(v) \in \{0, ..., n - 1\}}. Това са \(n\) различни стойности. \\
    Да допуснем, че в графа има поне един изолиран връх. \\
    Тогава редицата от степените на върховете в графа започва с 0.
    Също така няма връх от степен \(n - 1\) - ако има такъв, то той е съсед на всички останали 
    върхове (включително на изолираните), което противоречи с допускането ни (че имаме изолирани върхове). 
    Показахме, че няма връх от степен \(n - 1\). \\
    Тогава \mexpr{\forall v \in V : d(v) \in \{0, ..., n - 2\}}, което са \(n - 1\) на брой стойности, 
    а ние имаме \(n\) върха. \\
    Тогава от принципа на Дирихле следва, че има поне 2 върха \(u\) и \(v\), такива че \mexpr{d(u) = d(v)}.
\end{proof}

\subsection*{Теорема за броя на маршрутите със зададена дължина в крайни ориентирани мултиграфи}
\begin{theorem}
    За всеки ориентиран мултиграф G и за всяко \(k \ge 0\) е вярно, че \mexpr{M^k[i, j]} е броят на 
    (ориентираните) пътища с дължина \(k\) от \(i\) до \(j\) в \(G\), където \(M\) е матрицата на 
    съседство на G. 
\end{theorem}

\begin{proof}
    С индукция по \(k\). \\
    \bu{База}: \(k = 0\) \\
    Тогава \(M^0\) е единичната матрица с единици по главния диагонал и нули извън него. \\
    Тогава за всички \mexpr{i, j \in \{1, ..., n\}, M^0[i, j]} е броят на пътищата с дължина 0 от \(i\) до \(j\):
    \begin{itemize}
        \item ако \(i \not = j\), такива пътища няма, което точо отговаря на факта, че \mexpr{M^0[i, j] = 0}
        \item ако \(i = j\), има точно 1 такъв път, а именно самият връх \(i\), което точно отговаря на 
        факта, че \mexpr{M^0[i, j] = M^0[i, i] = 1}
    \end{itemize}
    \bu{Индукционно предположение}: да допуснем, че твърдението е вярно за стойност на аргумента \(k\), т.е.
    \mexpr{M^k[i, j]} е броят на пътищата с дължина \(k\) от \(i\) до \(j\). \\
    \bu{Индукционна стъпка}: ще докажем твърдението за стойност на аргумента \(k + 1\). \\
    Нека с \(T_{i, j}^l\) означим множеството от пътищата от \(i\) до \(j\) с дължина \(l \ge 0\). Ще 
    докажем, че \(M^k[i, j] = |T_{i, j}^k|\) влече \(M^{k + 1}[i, j] = |T_{i, j}^{k + 1}|\) за всички 
    \mexpr{i, j \in \{1, ..., n\}}. \\
    (От къде? Защо?) За лявата страна имаме, че \mexpr{M^{k + 1}[i, j] = \sum_{1 \le s \le n} M^{k}[i, s].M[s, j]} (1) \\
    Да разгледаме дясната страна \mexpr{|T_{i, j}^{k + 1}|}. \\
    Тъй като \(k + 1 \ge 1\), всеки път от множеството \(T_{i, j}^{k + 1}\) има предпоследен връх, при това 
    точно един. Тогава \(T_{i, j}^{k + 1}\) се разбива на \(n\) множества (може да са празни) по 
    предпоследен връх. \\
    Нека с \(W_{i, j, s}^l\) означим множеството от пътищата от \(i\) до \(j\) с предпоследен връх \(s\) 
    и дължина \(l \ge 1\) за \mexpr{i, j, s \in \{1, ..., n\}}.
    Така \(T_{i, j}^{k + 1}\) има разбиване \mexpr{\{W_{i, j, 1}^{k + 1}, W_{i, j, 2}^{k + 1}, ..., 
    W_{i, j, n}^{k + 1}}, като някои (или всички) дялове на това разбиване може да са празни. \\
    Съгласно принципа на разбиването следва, че \mexpr{|T_{i, j}^{k + 1}| = \sum_{1 \le s \le n} |W_{i, j, s}^{k + 1}|} (2)

    Илюстрация на разбиването на множеството \(W_{i, j, s}^{k + 1}\): \\
    % TODO: diagram
    Тогава \(W_{i, j, s}^{k + 1}\) се явява като Декартово произведение на \(T_{i, j}^{k}\) и множеството 
    от ребрата от \(s\) до \(j\). Така всеки път от \(W_{i, j, s}^{k + 1}\) се явява комбинация на един път 
    от \(T_{i, s}^{k}\) и едно ребро от \(s\) до \(j\). Тоест броят на начините да стигнем от \(i\) до \(j\) 
    с точно \(k + 1\) ребра и \(s\) за предпоследен връх е произведението от:
    \begin{itemize}
        \item броя на начините да стигнем от \(i\) до \(s\) с точно \(k\) ребра
        \item броя на начините да стигнем от \(s\) до \(j\) с точно 1 ребро
    \end{itemize}
    Тогава броят на ребрата от \(s\) до \(j\) е \(M[s, j]\). \\
    Следователно \mexpr{|W_{i, j, s}^{k + 1}| = |T_{i, s}^k|.M[s, j]}. (3) \\
    От (2) и (3) следва, че \mexpr{|T_{i, j}^{k + 1}| = \sum_{1 \le s \le n} |T_{i, s}^k|.M[s, j]}. (4) \\
    От И.П. имаме, че \mexpr{|T_{i, s}^k| = M^k[i, s]}. \\
    Тогава \mexpr{|T_{i, j}^{k + 1}| = \sum_{1 \le s \le n} M^k[i, s].M[s, j] = M^{k + 1}[i, j]}.
\end{proof}